<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">

	<!-- TITLE OF SITE -->
	<title>Download Treehouse course in HD</title>

	<!-- META DATA -->
	<meta name="description" content="Download Treehouse course in HD" />
	<meta name="keywords" content="treehouse, in hd, download treehouse" />
	<meta name="author" content="Anwar Hussain">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- =========================
	FAV AND TOUCH ICONS  
	============================== -->
	<link rel="icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

	<!-- =========================
	 STYLESHEETS 
	============================== -->
	<!-- BOOTSTRAP CSS -->
	<link rel="stylesheet" href="css/bootstrap.min.css">

	<!-- GOOGLE FONTS -->
	<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Hind:400,600'>

	<!-- CUSTOM CSS -->
	<link rel="stylesheet" href="css/style.css">

	<!-- RESPONSIVE FIXES -->
	<!-- <link rel="stylesheet" href="css/responsive.css"> -->

	<!--[if lt IE 9]>
	      <script src="js/html5shiv.js"></script>
	      <script src="js/respond.min.js"></script>
	<![endif]-->

</head>
<body>
<section class="home">
	<div class="container">
		<div class="row">
			<div class="col-md-8 col-md-offset-2 text-center plr100">

				<h1 class="title-text">Download Treehouse course in HD</h1>
				<p class="sub-title">Wait! Still you need a subscription!</p>
				
				<form action="#" id="treehouse-download" class="form-horizontal">
					<div class="form-group">
						<label for="url" class="col-md-3">Course URL: </label>
						<div class="col-md-9">
							<input type="text" class="form-control" name="url" id="url" placeholder="eg: https://teamtreehouse.com/library/php-functions-2">
						</div>
					</div>

					<div class="form-group">
						<label for="token" class="col-md-3">Your Token: </label>
						<div class="col-md-9">
							<input type="text" class="form-control" name="token" id="token" placeholder="eg: eb1e83ef-9b7e-47f5-92ba-a59bc84bd9cf">

							<p class="note">*Note: Don't know your token? Paste RSS link.</p>
						</div>
					</div>

					<button type="submit" id="submitBtn" class="btn btn-base btn-lg">Download</button>

				</form>

				<div class="result">
					<p class="success_msg"></p>
					<p class="error_msg"></p>
				</div>

			</div>
		</div>
	</div>
</section>
	

<!-- =========================
     SCRIPTS
============================== -->
<script>

	var errorMsg;
	var submitBtn = document.getElementById('submitBtn');
	var result = document.querySelector('.error_msg');

	/******************** LEFT NAVBAR ********************/
	submitBtn.addEventListener('click', function(e) {
		e.preventDefault();

		// get link
		var link = document.getElementById('url').value;
		var token = document.getElementById('token').value;

		if ( token.indexOf('itpc') > -1 ) {
			var fetchToken = token.replace(/^.+token=(.+)/g, '$1');
			token = fetchToken;
			document.getElementById('token').value = token;
		}

		var linkHD = link.replace(/https?(:\/\/teamtreehouse.+)/g, 'itpc$1.rss?feed_token=' + token + '&hd=true');

		window.location.href = linkHD;
	});
</script>
</body>
</html>